<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>APIs · Izanami</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='Izanami'/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../js/page.js"></script>
<script type="text/javascript" src="../js/groups.js"></script>
<link rel="stylesheet" type="text/css" href="../lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="../lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="../css/page.css"/>

<!--
<link rel="shortcut icon" href="../images/favicon.ico" />
-->
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Izanami
</a>
<div class="version-number">
1.2.1*
</div>
</div>
<select class="supergroup" name="Language"><option class="group" value="group-scala">Scala</option><option class="group" value="group-java">Java</option></select>
<div class="nav-toc">
<ul>
  <li><a href="../quickstart.html" class="page">Quick start</a></li>
  <li><a href="../about.html" class="page">About Izanami</a></li>
  <li><a href="../philosophy.html" class="page">Philosophy</a></li>
  <li><a href="../features.html" class="page">What&rsquo;s in the box</a></li>
  <li><a href="../architecture/index.html" class="page">Architecture</a></li>
  <li><a href="../getizanami/index.html" class="page">Get Izanami</a>
  <ul>
    <li><a href="../getizanami/binaries.html" class="page">From Binaries</a></li>
    <li><a href="../getizanami/docker.html" class="page">From Docker</a></li>
    <li><a href="../getizanami/fromsources.html" class="page">From sources</a></li>
  </ul></li>
  <li><a href="../settings/index.html" class="page">Settings</a>
  <ul>
    <li><a href="../settings/database.html" class="page">Choose the database</a></li>
    <li><a href="../settings/settings.html" class="page">All the settings</a></li>
  </ul></li>
  <li><a href="../ui.html" class="page">UI usage</a></li>
  <li><a href="../api.html" class="page">APIs usage</a></li>
  <li><a href="../configs/index.html" class="page">Shared Configs</a>
  <ul>
    <li><a href="../configs/ui.html" class="page">The UI</a></li>
    <li><a href="../configs/api.html" class="page">APIs</a></li>
  </ul></li>
  <li><a href="../features/index.html" class="page">Feature flipping</a>
  <ul>
    <li><a href="../features/ui.html" class="page">The UI</a></li>
    <li><a href="../features/api.html" class="active page">APIs</a></li>
  </ul></li>
  <li><a href="../experiments/index.html" class="page">A/B testing</a>
  <ul>
    <li><a href="../experiments/ui.html" class="page">The UI</a></li>
    <li><a href="../experiments/api.html" class="page">APIs</a></li>
  </ul></li>
  <li><a href="../keys.html" class="page">Key definition and best practices</a></li>
  <li><a href="../events.html" class="page">Listen to events</a></li>
  <li><a href="../clients/index.html" class="page">Clients</a>
  <ul>
    <li><a href="../clients/jvm.html" class="page">Java &amp; Scala</a></li>
    <li><a href="../clients/react.html" class="page">React client</a></li>
    <li><a href="../clients/angular.html" class="page">Angular client</a></li>
    <li><a href="../clients/node.html" class="page">Node js client</a></li>
    <li><a href="../clients/cli.html" class="page">CLI</a></li>
  </ul></li>
  <li><a href="../tutorials/index.html" class="page">Tutorials</a>
  <ul>
    <li><a href="../tutorials/spring.html" class="page">Spring / React tutorial</a></li>
  </ul></li>
  <li><a href="../performances.html" class="page">Performances</a></li>
  <li><a href="../developers/index.html" class="page">For Developers</a></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<header class="site-header expanded row">
<div class="small-12 column">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title-wrapper">
<div class="title-logo"></div>
<div class="title"><a href="../index.html">Izanami</a></div>
</div>
<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column">
<nav class="site-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Izanami
</a>
<div class="version-number">
1.2.1*
</div>
</div>
<select class="supergroup" name="Language"><option class="group" value="group-scala">Scala</option><option class="group" value="group-java">Java</option></select>
<div class="nav-toc">
<ul>
  <li><a href="../quickstart.html" class="page">Quick start</a></li>
  <li><a href="../about.html" class="page">About Izanami</a></li>
  <li><a href="../philosophy.html" class="page">Philosophy</a></li>
  <li><a href="../features.html" class="page">What&rsquo;s in the box</a></li>
  <li><a href="../architecture/index.html" class="page">Architecture</a></li>
  <li><a href="../getizanami/index.html" class="page">Get Izanami</a>
  <ul>
    <li><a href="../getizanami/binaries.html" class="page">From Binaries</a></li>
    <li><a href="../getizanami/docker.html" class="page">From Docker</a></li>
    <li><a href="../getizanami/fromsources.html" class="page">From sources</a></li>
  </ul></li>
  <li><a href="../settings/index.html" class="page">Settings</a>
  <ul>
    <li><a href="../settings/database.html" class="page">Choose the database</a></li>
    <li><a href="../settings/settings.html" class="page">All the settings</a></li>
  </ul></li>
  <li><a href="../ui.html" class="page">UI usage</a></li>
  <li><a href="../api.html" class="page">APIs usage</a></li>
  <li><a href="../configs/index.html" class="page">Shared Configs</a>
  <ul>
    <li><a href="../configs/ui.html" class="page">The UI</a></li>
    <li><a href="../configs/api.html" class="page">APIs</a></li>
  </ul></li>
  <li><a href="../features/index.html" class="page">Feature flipping</a>
  <ul>
    <li><a href="../features/ui.html" class="page">The UI</a></li>
    <li><a href="../features/api.html" class="active page">APIs</a></li>
  </ul></li>
  <li><a href="../experiments/index.html" class="page">A/B testing</a>
  <ul>
    <li><a href="../experiments/ui.html" class="page">The UI</a></li>
    <li><a href="../experiments/api.html" class="page">APIs</a></li>
  </ul></li>
  <li><a href="../keys.html" class="page">Key definition and best practices</a></li>
  <li><a href="../events.html" class="page">Listen to events</a></li>
  <li><a href="../clients/index.html" class="page">Clients</a>
  <ul>
    <li><a href="../clients/jvm.html" class="page">Java &amp; Scala</a></li>
    <li><a href="../clients/react.html" class="page">React client</a></li>
    <li><a href="../clients/angular.html" class="page">Angular client</a></li>
    <li><a href="../clients/node.html" class="page">Node js client</a></li>
    <li><a href="../clients/cli.html" class="page">CLI</a></li>
  </ul></li>
  <li><a href="../tutorials/index.html" class="page">Tutorials</a>
  <ul>
    <li><a href="../tutorials/spring.html" class="page">Spring / React tutorial</a></li>
  </ul></li>
  <li><a href="../performances.html" class="page">Performances</a></li>
  <li><a href="../developers/index.html" class="page">For Developers</a></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column">
<section class="site-content">

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="../index.html">Izanami</a></li>
  <li><a href="../features/index.html">Feature flipping</a></li>
  <li>APIs</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#apis" name="apis" class="anchor"><span class="anchor-link"></span></a>APIs</h1>
<div class="toc ">
<ul>
  <li><a href="../features/api.html#data-model" class="header">Data model</a>
  <ul>
    <li><a href="../features/api.html#no-strategy-format" class="header">NO_STRATEGY format</a></li>
    <li><a href="../features/api.html#release-date-format" class="header">RELEASE_DATE format</a></li>
    <li><a href="../features/api.html#date-range-format" class="header">DATE_RANGE format</a></li>
    <li><a href="../features/api.html#script-format" class="header">SCRIPT format</a></li>
    <li><a href="../features/api.html#global-script-format" class="header">GLOBAL_SCRIPT format</a></li>
    <li><a href="../features/api.html#percentage-format" class="header">PERCENTAGE format</a></li>
  </ul></li>
  <li><a href="../features/api.html#crud-api" class="header">CRUD API</a>
  <ul>
    <li><a href="../features/api.html#list-all" class="header">List all</a></li>
    <li><a href="../features/api.html#create-a-feature" class="header">Create a feature</a></li>
    <li><a href="../features/api.html#get-a-feature" class="header">Get a feature</a></li>
    <li><a href="../features/api.html#update-a-feature" class="header">Update a feature</a></li>
    <li><a href="../features/api.html#patch-a-feature" class="header">Patch a feature</a></li>
    <li><a href="../features/api.html#delete-a-feature" class="header">Delete a feature</a></li>
  </ul></li>
  <li><a href="../features/api.html#check-features" class="header">Check features</a>
  <ul>
    <li><a href="../features/api.html#check-a-feature-without-context" class="header">Check a feature without context</a></li>
    <li><a href="../features/api.html#check-a-feature-with-context" class="header">Check a feature with context</a></li>
    <li><a href="../features/api.html#the-tree-api" class="header">The Tree API</a></li>
    <li><a href="../features/api.html#list-features-with-the-active-attribute-without-context" class="header">List features with the active attribute without context</a></li>
    <li><a href="../features/api.html#list-features-with-the-active-attribute-with-context" class="header">List features with the active attribute with context</a></li>
  </ul></li>
  <li><a href="../features/api.html#download-and-upload" class="header">Download and Upload</a>
  <ul>
    <li><a href="../features/api.html#download" class="header">Download</a></li>
    <li><a href="../features/api.html#upload" class="header">Upload</a></li>
  </ul></li>
</ul>
</div>
<h2><a href="#data-model" name="data-model" class="anchor"><span class="anchor-link"></span></a>Data model</h2>
<p>The feature structure depends on the type of the strategy. A feature can have the following strategies: </p>
<ul>
  <li><code>NO_STRATEGY</code>: active or inactive</li>
  <li><code>RELEASE_DATE</code>: active on a specific date</li>
  <li><code>DATE_RANGE</code>: active between two date</li>
  <li><code>SCRIPT</code>: Activation depends on the execution of a js script</li>
  <li><code>GLOBAL_SCRIPT</code>: Activation depends on the execution of a js script shared across feature</li>
  <li><code>PERCENTAGE</code>: Active for a percentage of client</li>
</ul>
<h3><a href="#no-strategy-format" name="no-strategy-format" class="anchor"><span class="anchor-link"></span></a>NO_STRATEGY format</h3>
<pre class="prettyprint"><code class="language-json">{
  &quot;id&quot;: &quot;basic:feature&quot;,
  &quot;enabled&quot;: true,
  &quot;activationStrategy&quot;: &quot;NO_STRATEGY&quot;
}
</code></pre>
<h3><a href="#release-date-format" name="release-date-format" class="anchor"><span class="anchor-link"></span></a>RELEASE_DATE format</h3>
<pre class="prettyprint"><code class="language-json">{
  &quot;id&quot;: &quot;feature:with:date&quot;,
  &quot;enabled&quot;: true,
  &quot;parameters&quot;: {
    &quot;releaseDate&quot;: &quot;13/12/2017 10:29:04&quot;
  },
  &quot;activationStrategy&quot;: &quot;RELEASE_DATE&quot;
}
</code></pre>
<h3><a href="#date-range-format" name="date-range-format" class="anchor"><span class="anchor-link"></span></a>DATE_RANGE format</h3>
<pre class="prettyprint"><code class="language-json">{
  &quot;id&quot;: &quot;feature:with:datetange&quot;,
  &quot;enabled&quot;: true,
  &quot;parameters&quot;: {
    &quot;from&quot;: &quot;2017-12-13 10:29:04&quot;,
    &quot;to&quot;: &quot;2017-12-14 00:45:23&quot;
  },
  &quot;activationStrategy&quot;: &quot;DATE_RANGE&quot;
}
</code></pre>
<h3><a href="#script-format" name="script-format" class="anchor"><span class="anchor-link"></span></a>SCRIPT format</h3>
<pre class="prettyprint"><code class="language-json">{
  &quot;id&quot;: &quot;feature:with:script&quot;,
  &quot;enabled&quot;: true,
  &quot;parameters&quot;: {
    &quot;type&quot;: &quot;javascript&quot;,
    &quot;script&quot;: &quot;/**\n * context:  a JSON object containing app specific value \n *           to evaluate the state of the feature\n * enabled:  a callback to mark the feature as active \n *           for this request\n * disabled: a callback to mark the feature as inactive \n *           for this request \n * http:     a http client\n */ \nfunction enabled(context, enabled, disabled, http) {\n  if (context.user === &#39;ragnar.lodbrok@gmail.com&#39;) {\n    return enabled();\n  }\n  return disabled();\n}&quot;
  },
  &quot;activationStrategy&quot;: &quot;SCRIPT&quot;
}
</code></pre>
<h3><a href="#global-script-format" name="global-script-format" class="anchor"><span class="anchor-link"></span></a>GLOBAL_SCRIPT format</h3>
<pre class="prettyprint"><code class="language-json">{
  &quot;id&quot;: &quot;feature:with:global:script&quot;,
  &quot;enabled&quot;: false,
  &quot;parameters&quot;: {
    &quot;ref&quot;: &quot;project:script:ref&quot;
  },
  &quot;activationStrategy&quot;: &quot;GLOBAL_SCRIPT&quot;
}
</code></pre>
<h3><a href="#percentage-format" name="percentage-format" class="anchor"><span class="anchor-link"></span></a>PERCENTAGE format</h3>
<pre class="prettyprint"><code class="language-json">{
  &quot;id&quot;: &quot;feature:with:percentage&quot;,
  &quot;enabled&quot;: false,
  &quot;parameters&quot;: {
    &quot;percentage&quot;: 60
  },
  &quot;activationStrategy&quot;: &quot;PERCENTAGE&quot;
}
</code></pre>
<h2><a href="#crud-api" name="crud-api" class="anchor"><span class="anchor-link"></span></a>CRUD API</h2>
<p>Features expose a classic CRUD REST api : </p>
<h3><a href="#list-all" name="list-all" class="anchor"><span class="anchor-link"></span></a>List all</h3>
<pre class="prettyprint"><code class="language-bash">curl -X GET \
  &#39;http://localhost:9000/api/features?pattern=feature:*&amp;page=1&amp;pageSize=15&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; | jq
</code></pre>
<p>Will respond with a 200 status code: </p>
<pre class="prettyprint"><code class="language-json">{
  &quot;results&quot;: [
    {
      &quot;id&quot;: &quot;feature:with:date&quot;,
      &quot;enabled&quot;: true,
      &quot;parameters&quot;: {
        &quot;releaseDate&quot;: &quot;13/12/2017 10:29:04&quot;
      },
      &quot;activationStrategy&quot;: &quot;RELEASE_DATE&quot;
    },
    {
      &quot;id&quot;: &quot;feature:with:script&quot;,
      &quot;enabled&quot;: true,
      &quot;parameters&quot;: {
        &quot;type&quot;: &quot;javascript&quot;,
        &quot;script&quot;: &quot;/**\n * context:  a JSON object containing app specific value \n *           to evaluate the state of the feature\n * enabled:  a callback to mark the feature as active \n *           for this request\n * disabled: a callback to mark the feature as inactive \n *           for this request \n * http:     a http client\n */ \nfunction enabled(context, enabled, disabled, http) {\n  if (context.user === &#39;ragnar.lodbrok@gmail.com&#39;) {\n    return enabled();\n  }\n  return disabled();\n}&quot;
      },
      &quot;activationStrategy&quot;: &quot;SCRIPT&quot;
    },
    {
      &quot;id&quot;: &quot;feature:with:global:script&quot;,
      &quot;enabled&quot;: true,
      &quot;parameters&quot;: {
        &quot;ref&quot;: &quot;project:script2&quot;
      },
      &quot;activationStrategy&quot;: &quot;GLOBAL_SCRIPT&quot;
    }
  ],
  &quot;metadata&quot;: {
    &quot;page&quot;: 1,
    &quot;pageSize&quot;: 15,
    &quot;count&quot;: 3,
    &quot;nbPages&quot;: 1
  }
}
</code></pre>
<p>The query params are optional and the value used in this example are the default one. </p>
<h3><a href="#create-a-feature" name="create-a-feature" class="anchor"><span class="anchor-link"></span></a>Create a feature</h3>
<pre class="prettyprint"><code class="language-bash">curl -XPOST \
    &#39;http://localhost:9000/api/features&#39; \
    -H &#39;Content-Type: application/json&#39; \
    -H &#39;Izanami-Client-Id: xxxx&#39; \
    -H &#39;Izanami-Client-Secret: xxxx&#39; \
    -d &#39;{ &quot;id&quot;: &quot;really:basic:feature&quot;, &quot;enabled&quot;: true, &quot;activationStrategy&quot;: &quot;NO_STRATEGY&quot; }&#39; | jq  
</code></pre>
<p>Will respond with a 201 status code: </p>
<pre class="prettyprint"><code class="language-json">{
  &quot;id&quot;: &quot;really:basic:feature&quot;,
  &quot;enabled&quot;: true,
  &quot;activationStrategy&quot;: &quot;NO_STRATEGY&quot;
}
</code></pre>
<h3><a href="#get-a-feature" name="get-a-feature" class="anchor"><span class="anchor-link"></span></a>Get a feature</h3>
<pre class="prettyprint"><code class="language-bash">curl -X GET \
  &#39;http://localhost:9000/api/features/really:basic:feature&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; | jq
</code></pre>
<p>Will respond with a 200 status code:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;id&quot;: &quot;really:basic:feature&quot;,
  &quot;enabled&quot;: true,
  &quot;activationStrategy&quot;: &quot;NO_STRATEGY&quot;
}
</code></pre>
<h3><a href="#update-a-feature" name="update-a-feature" class="anchor"><span class="anchor-link"></span></a>Update a feature</h3>
<pre class="prettyprint"><code class="language-bash">curl -X PUT \
  &#39;http://localhost:9000/api/features/really:basic:feature&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; \
  -d &#39;{ &quot;id&quot;: &quot;really:basic:feature&quot;, &quot;enabled&quot;: false, &quot;activationStrategy&quot;: &quot;NO_STRATEGY&quot; }&#39; | jq
</code></pre>
<p>Will respond with a 200 status code:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;id&quot;: &quot;really:basic:feature&quot;,
  &quot;enabled&quot;: false,
  &quot;activationStrategy&quot;: &quot;NO_STRATEGY&quot;
}
</code></pre>
<h3><a href="#patch-a-feature" name="patch-a-feature" class="anchor"><span class="anchor-link"></span></a>Patch a feature</h3>
<p>Partial updates can be done using json patch : </p>
<pre class="prettyprint"><code class="language-bash">curl -X PATCH \
  &#39;http://localhost:9000/api/features/really:basic:feature&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; \
  -d &#39;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;enabled&quot;, &quot;value&quot;: false}]&#39;
</code></pre>
<p>Will respond with a 200 status code:</p>
<pre class="prettyprint"><code class="language-json">{ 
  &quot;id&quot;:&quot;really:basic:feature&quot;,
  &quot;enabled&quot;:false,
  &quot;activationStrategy&quot;:&quot;NO_STRATEGY&quot;
}
</code></pre>
<h3><a href="#delete-a-feature" name="delete-a-feature" class="anchor"><span class="anchor-link"></span></a>Delete a feature</h3>
<pre class="prettyprint"><code class="language-bash">curl -X DELETE \
  &#39;http://localhost:9000/api/features/really:basic:feature&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; | jq 
</code></pre>
<p>Will respond with a 200 status code:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;id&quot;: &quot;really:basic:feature&quot;,
  &quot;enabled&quot;: false,
  &quot;activationStrategy&quot;: &quot;NO_STRATEGY&quot;
}
</code></pre>
<p>As you can see, the keys are split with <code>:</code> and the values are </p>
<h2><a href="#check-features" name="check-features" class="anchor"><span class="anchor-link"></span></a>Check features</h2>
<p>We can divide the feature in two kind : </p>
<ul>
  <li>feature without context:
    <ul>
      <li><code>NO_STRATEGY</code> features</li>
      <li><code>RELEASE_DATE</code> features</li>
      <li><code>DATE_RANGE</code> features</li>
    </ul>
  </li>
  <li>feature needing context:
    <ul>
      <li><code>SCRIPT</code> features</li>
      <li><code>GLOBAL_SCRIPT</code> features</li>
      <li><code>PERCENTAGE</code> features</li>
    </ul>
  </li>
</ul>
<h3><a href="#check-a-feature-without-context" name="check-a-feature-without-context" class="anchor"><span class="anchor-link"></span></a>Check a feature without context</h3>
<pre class="prettyprint"><code class="language-bash">curl -X GET \
  &#39;http://localhost:9000/api/features/really:basic:feature/check&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; | jq
</code></pre>
<p>Will respond with a 200 status code:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;active&quot;: true
}
</code></pre>
<h3><a href="#check-a-feature-with-context" name="check-a-feature-with-context" class="anchor"><span class="anchor-link"></span></a>Check a feature with context</h3>
<pre class="prettyprint"><code class="language-bash">curl -X POST \
  &#39;http://localhost:9000/api/features/feature:with:script/check&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; \
  -d &#39;{ &quot;user&quot;: &quot;ragnar.lodbrok@gmail.com&quot; }&#39; | jq
</code></pre>
<p>Will respond with a 200 status code:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;active&quot;: true
}
</code></pre>
<p>The percentage strategy need a context with an id field in order to decide if the feature is active for this id. </p>
<pre class="prettyprint"><code class="language-bash">curl -X POST \
  &#39;http://localhost:9000/api/features/feature:with:percentage/check&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; \
  -d &#39;{ &quot;id&quot;: &quot;ragnar.lodbrok@gmail.com&quot; }&#39; | jq
</code></pre>
<p>Will respond with a 200 status code:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;active&quot;: true
}
</code></pre>
<h3><a href="#the-tree-api" name="the-tree-api" class="anchor"><span class="anchor-link"></span></a>The Tree API</h3>
<p>With the tree api you can check the features and get the results as tree. Be careful using this API because the results are not paged so be sure to use an appropriate pattern : </p>
<p>Check the features without context </p>
<pre class="prettyprint"><code class="language-bash">curl -X GET \
  &#39;http://localhost:9000/api/tree/features?pattern=feature:*&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; | jq
</code></pre>
<p>We will get the following response: </p>
<pre class="prettyprint"><code class="language-json">{
  &quot;feature&quot;: {
    &quot;simple&quot;: {
      &quot;active&quot;: true
    },
    &quot;with&quot;: {
      &quot;date&quot;: {
        &quot;active&quot;: true
      },
      &quot;script&quot;: {
        &quot;active&quot;: false
      },
      &quot;global&quot;: {
        &quot;script&quot;: {
          &quot;active&quot;: false
        }
      }
    }
  }
}
</code></pre>
<p>Or with context: </p>
<pre class="prettyprint"><code class="language-bash">curl -X POST \
  &#39;http://localhost:9000/api/tree/features?pattern=feature:*&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; \
  -d &#39;{ &quot;user&quot;: &quot;ragnar.lodbrok@gmail.com&quot; }&#39; \
  | jq
</code></pre>
<pre class="prettyprint"><code class="language-json">{
  &quot;feature&quot;: {
    &quot;simple&quot;: {
      &quot;active&quot;: true
    },
    &quot;with&quot;: {
      &quot;date&quot;: {
        &quot;active&quot;: true
      },
      &quot;script&quot;: {
        &quot;active&quot;: false
      },
      &quot;global&quot;: {
        &quot;script&quot;: {
          &quot;active&quot;: true
        }
      }
    }
  }
}
</code></pre>
<h3><a href="#list-features-with-the-active-attribute-without-context" name="list-features-with-the-active-attribute-without-context" class="anchor"><span class="anchor-link"></span></a>List features with the active attribute without context</h3>
<pre class="prettyprint"><code class="language-bash">curl -X GET \
  &#39;http://localhost:9000/api/features?pattern=feature:*&amp;active=true&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; | jq
</code></pre>
<p>The result is the following </p>
<pre class="prettyprint"><code class="language-json">{
  &quot;results&quot;: [
    {
      &quot;id&quot;: &quot;feature:simple&quot;,
      &quot;enabled&quot;: true,
      &quot;activationStrategy&quot;: &quot;NO_STRATEGY&quot;,
      &quot;active&quot;: true
    },
    {
      &quot;id&quot;: &quot;feature:with:date&quot;,
      &quot;enabled&quot;: true,
      &quot;parameters&quot;: {
        &quot;releaseDate&quot;: &quot;13/12/2017 10:29:04&quot;
      },
      &quot;activationStrategy&quot;: &quot;RELEASE_DATE&quot;,
      &quot;active&quot;: true
    },
    {
      &quot;id&quot;: &quot;feature:with:script&quot;,
      &quot;enabled&quot;: true,
      &quot;parameters&quot;: {
        &quot;type&quot;: &quot;javascript&quot;,
        &quot;script&quot;: &quot;/**\n * context:  a JSON object containing app specific value \n *           to evaluate the state of the feature\n * enabled:  a callback to mark the feature as active \n *           for this request\n * disabled: a callback to mark the feature as inactive \n *           for this request \n * http:     a http client\n */ \nfunction enabled(context, enabled, disabled, http) {\n  if (context.user === &#39;ragnar.lodbrok@gmail.com&#39;) {\n    return enabled();\n  }\n  return disabled();\n}&quot;
      },
      &quot;activationStrategy&quot;: &quot;SCRIPT&quot;,
      &quot;active&quot;: false
    },
    {
      &quot;id&quot;: &quot;feature:with:global:script&quot;,
      &quot;enabled&quot;: true,
      &quot;parameters&quot;: {
        &quot;ref&quot;: &quot;project:script2&quot;
      },
      &quot;activationStrategy&quot;: &quot;GLOBAL_SCRIPT&quot;,
      &quot;active&quot;: false
    }
  ],
  &quot;metadata&quot;: {
    &quot;page&quot;: 1,
    &quot;pageSize&quot;: 15,
    &quot;count&quot;: 4,
    &quot;nbPages&quot;: 1
  }
}
</code></pre>
<h3><a href="#list-features-with-the-active-attribute-with-context" name="list-features-with-the-active-attribute-with-context" class="anchor"><span class="anchor-link"></span></a>List features with the active attribute with context</h3>
<pre class="prettyprint"><code class="language-bash">curl -X POST \
  &#39;http://localhost:9000/api/features/_checks?pattern=feature:*&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; \
  -d &#39;{ &quot;user&quot;: &quot;ragnar.lodbrok@gmail.com&quot; }&#39; \
  | jq
</code></pre>
<p>The result is the following </p>
<pre class="prettyprint"><code class="language-json">{
  &quot;results&quot;: [
    {
      &quot;id&quot;: &quot;feature:simple&quot;,
      &quot;enabled&quot;: true,
      &quot;activationStrategy&quot;: &quot;NO_STRATEGY&quot;,
      &quot;active&quot;: true
    },
    {
      &quot;id&quot;: &quot;feature:with:date&quot;,
      &quot;enabled&quot;: true,
      &quot;parameters&quot;: {
        &quot;releaseDate&quot;: &quot;13/12/2017 10:29:04&quot;
      },
      &quot;activationStrategy&quot;: &quot;RELEASE_DATE&quot;,
      &quot;active&quot;: true
    },
    {
      &quot;id&quot;: &quot;feature:with:script&quot;,
      &quot;enabled&quot;: true,
      &quot;parameters&quot;: {
        &quot;type&quot;: &quot;javascript&quot;,
        &quot;script&quot;: &quot;/**\n * context:  a JSON object containing app specific value \n *           to evaluate the state of the feature\n * enabled:  a callback to mark the feature as active \n *           for this request\n * disabled: a callback to mark the feature as inactive \n *           for this request \n * http:     a http client\n */ \nfunction enabled(context, enabled, disabled, http) {\n  if (context.user === &#39;ragnar.lodbrok@gmail.com&#39;) {\n    return enabled();\n  }\n  return disabled();\n}&quot;
      },
      &quot;activationStrategy&quot;: &quot;SCRIPT&quot;,
      &quot;active&quot;: true
    },
    {
      &quot;id&quot;: &quot;feature:with:global:script&quot;,
      &quot;enabled&quot;: true,
      &quot;parameters&quot;: {
        &quot;ref&quot;: &quot;project:script2&quot;
      },
      &quot;activationStrategy&quot;: &quot;GLOBAL_SCRIPT&quot;,
      &quot;active&quot;: false
    }
  ],
  &quot;metadata&quot;: {
    &quot;page&quot;: 1,
    &quot;pageSize&quot;: 15,
    &quot;count&quot;: 4,
    &quot;nbPages&quot;: 1
  }
}
</code></pre>
<h2><a href="#download-and-upload" name="download-and-upload" class="anchor"><span class="anchor-link"></span></a>Download and Upload</h2>
<p>Download and upload is done using the <a href="http://ndjson.org/">nd-json</a> format. </p>
<h3><a href="#download" name="download" class="anchor"><span class="anchor-link"></span></a>Download</h3>
<pre class="prettyprint"><code class="language-bash">curl -X GET \
  &#39;http://localhost:9000/api/features.ndjson&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; | jq
</code></pre>
<p>Will return each item separated by a <code>\n</code>.</p>
<pre class="prettyprint"><code class="language-nd-json">{
  &quot;id&quot;: &quot;feature:simple1&quot;,
  &quot;enabled&quot;: true,
  &quot;activationStrategy&quot;: &quot;NO_STRATEGY&quot;
}
{
  &quot;id&quot;: &quot;feature:simple2&quot;,
  &quot;enabled&quot;: true,
  &quot;activationStrategy&quot;: &quot;NO_STRATEGY&quot;
}
</code></pre>
<h3><a href="#upload" name="upload" class="anchor"><span class="anchor-link"></span></a>Upload</h3>
<pre class="prettyprint"><code class="language-bash">curl -X POST \
  &#39;http://localhost:9000/api/features.ndjson&#39; \
  -H &#39;Content-Type: application/nd-json&#39; \
  -H &#39;Izanami-Client-Id: xxxx&#39; \
  -H &#39;Izanami-Client-Secret: xxxx&#39; \
  -d &#39;{&quot;id&quot;: &quot;feature:simple1&quot;,&quot;enabled&quot;: true,&quot;activationStrategy&quot;: &quot;NO_STRATEGY&quot;,&quot;active&quot;: true} 
      {&quot;id&quot;: &quot;feature:simple2&quot;,&quot;enabled&quot;: true,&quot;activationStrategy&quot;: &quot;NO_STRATEGY&quot;,&quot;active&quot;: true}&#39; \
   | jq 
</code></pre>
<p>Will return </p>
<pre class="prettyprint"><code class="language-json">{
  &quot;success&quot;: 2,
  &quot;errors&quot;: {
    &quot;errors&quot;: [],
    &quot;fieldErrors&quot;: {}
  }
}
</code></pre>
<div class="source-github">
The source code for this page can be found <a href="https://github.com/MAIF/izanami/tree/master/izanami-documentation/src/main/paradox/features/api.md">here</a>.
</div>

<div class="nav-next">
<p><strong>Next:</strong> <a href="../experiments/index.html">A/B testing</a></p>
</div>
</div>
<div class="large-3 show-for-large column" data-sticky-container>
<nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
<div class="page-nav">
<div class="nav-title">On this page:</div>
<div class="nav-toc">
<ul>
  <li><a href="../features/api.html#apis" class="header">APIs</a>
  <ul>
    <li><a href="../features/api.html#data-model" class="header">Data model</a></li>
    <li><a href="../features/api.html#crud-api" class="header">CRUD API</a></li>
    <li><a href="../features/api.html#check-features" class="header">Check features</a></li>
    <li><a href="../features/api.html#download-and-upload" class="header">Download and Upload</a></li>
  </ul></li>
</ul>
</div>
</div>
</nav>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2018</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="../lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../js/magellan.js"></script>

<style type="text/css">@import "../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-112498312-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-112498312-1');
</script>
</html>




