"use strict";(self.webpackChunkizanami_documentation=self.webpackChunkizanami_documentation||[]).push([[9723],{877:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>h});var i=s(5893),t=s(1151),d=s(1361);const r=s.p+"assets/images/cluster-mode-65a83e86413c5796a82ac2850b0b77d5.png",a={title:"Cluster mode"},l=void 0,o={id:"guides/cluster-mode",title:"Cluster mode",description:"Cluster mode is available from Izanami 2.15.0.",source:"@site/docs/04-guides/21-cluster-mode.mdx",sourceDirName:"04-guides",slug:"/guides/cluster-mode",permalink:"/izanami/docs/guides/cluster-mode",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:21,frontMatter:{title:"Cluster mode"},sidebar:"tutorialSidebar",previous:{title:"OAuth2 rights",permalink:"/izanami/docs/guides/oidc-configuration"},next:{title:"Clients",permalink:"/izanami/docs/clients/"}},c={},h=[{value:"What is cluster mode",id:"what-is-cluster-mode",level:2},{value:"Setting cluster mode",id:"setting-cluster-mode",level:3},{value:"Worker mode",id:"worker-mode",level:3},{value:"Leader mode",id:"leader-mode",level:3},{value:"Standalone mode",id:"standalone-mode",level:3},{value:"Mode summary",id:"mode-summary",level:3},{value:"Instanciation example",id:"instanciation-example",level:3},{value:"Worker specialization",id:"worker-specialization",level:2}];function m(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(d.j,{children:"Cluster mode is available from Izanami 2.15.0."}),"\n",(0,i.jsxs)(n.p,{children:["Izanami can be started in different ",(0,i.jsx)(n.strong,{children:"cluster modes"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"These modes impact behaviour of Izanami and which endpoints will respond."}),"\n",(0,i.jsx)(n.h2,{id:"what-is-cluster-mode",children:"What is cluster mode"}),"\n",(0,i.jsx)(n.p,{children:"Cluster mode allows to separate two Izanami usages:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"UI access to create / update / delete entities (feature, projects, tenants, ...)"}),"\n",(0,i.jsx)(n.li,{children:"Client access to evaluate feature state"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Leader / worker modes allow separating these concerns to prevent UI from being impacted by spikes of client queries."}),"\n",(0,i.jsx)(d.j,{children:(0,i.jsx)(n.p,{children:"Scaling worker will help handling spikes of requests, however keep in mind that both leader and worker nodes use the same underlying database.\nAt some point you may want to scale database as well."})}),"\n",(0,i.jsx)(n.h3,{id:"setting-cluster-mode",children:"Setting cluster mode"}),"\n",(0,i.jsx)(n.p,{children:"Cluster mode can be set using either:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"app.cluster.mode"})," JAVA commande line argument"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"IZANAMI_CLUSTER_MODE"})," environnement variable"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Possible values are ",(0,i.jsx)(n.code,{children:"standlone"}),", ",(0,i.jsx)(n.code,{children:"worker"})," and ",(0,i.jsx)(n.code,{children:"leader"}),", default value is ",(0,i.jsx)(n.code,{children:"standalone"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"worker-mode",children:"Worker mode"}),"\n",(0,i.jsxs)(n.p,{children:["Instantiating Izanami in ",(0,i.jsx)(n.code,{children:"worker"})," mode will:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Allow it to respond to feature evaluation requests"}),"\n",(0,i.jsxs)(n.li,{children:["prevent it from serving UI and associated admin endpoints (including call using ",(0,i.jsx)(n.a,{href:"./personnal-access-tokens",children:"Personnal Access Tokens"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"leader-mode",children:"Leader mode"}),"\n",(0,i.jsxs)(n.p,{children:["Instantiating Izanami in ",(0,i.jsx)(n.code,{children:"leader"})," mode will:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Prevent it from responding to feature evaluation requests"}),"\n",(0,i.jsxs)(n.li,{children:["Allow it to serve UI and associated admin endpoints (including call using ",(0,i.jsx)(n.a,{href:"./personnal-access-tokens",children:"Personnal Access Tokens"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"standalone-mode",children:"Standalone mode"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"standalone"})," mode is the default mode. When an instance is started in standalong mode, it will serve both the UI (and associated admin endpoints) and client endpoints."]}),"\n",(0,i.jsx)(n.h3,{id:"mode-summary",children:"Mode summary"}),"\n",(0,i.jsx)("div",{className:"checkmark-table",children:(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{}),(0,i.jsx)(n.th,{children:"Expose UI"}),(0,i.jsxs)(n.th,{children:["Expose admin endpoints",(0,i.jsx)("br",{}),"(through Personnal Access Tokens)"]}),(0,i.jsx)(n.th,{children:"Expose client (feature evaluation) endpoints"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Worker"}),(0,i.jsx)(n.td,{children:"\u274c"}),(0,i.jsx)(n.td,{children:"\u274c"}),(0,i.jsx)(n.td,{children:"\u2705"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Leader"}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"\u274c"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Standalone"}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"\u2705"})]})]})]})}),"\n",(0,i.jsx)(n.h3,{id:"instanciation-example",children:"Instanciation example"}),"\n",(0,i.jsxs)("figure",{children:[(0,i.jsx)("img",{src:r,width:"100%"}),(0,i.jsx)("figcaption",{children:"Cluster mode instanciation example"})]}),"\n",(0,i.jsx)(n.h2,{id:"worker-specialization",children:"Worker specialization"}),"\n",(0,i.jsxs)(n.p,{children:["In order to prevent accidental calls from one environnement to another, Izanami allows defining ",(0,i.jsx)(n.strong,{children:"blocklist"})," and ",(0,i.jsx)(n.strong,{children:"allowlist"})," on worker instances."]}),"\n",(0,i.jsxs)(n.p,{children:["Read ",(0,i.jsx)(n.a,{href:"/izanami/docs/guides/configuration#worker-instances-context-allowlist--blocklist",children:"dedicated configuration section"})," to learn more about these blocklists and allowlists."]})]})}function u(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(m,{...e})}):m(e)}},1361:(e,n,s)=>{s.d(n,{j:()=>r});const i={description__trivia:"description__trivia_yesz"};var t=s(4625),d=s(5893);function r(e){let{children:n}=e;return(0,d.jsxs)("div",{className:i.description__trivia,children:[(0,d.jsx)("img",{src:t.Z}),(0,d.jsx)("div",{children:n})]})}},4625:(e,n,s)=>{s.d(n,{Z:()=>i});const i=s.p+"assets/images/izanami_compressed-659337582c1667d92966e42fa1bfea3f.webp"},1151:(e,n,s)=>{s.d(n,{Z:()=>a,a:()=>r});var i=s(7294);const t={},d=i.createContext(t);function r(e){const n=i.useContext(d);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(d.Provider,{value:n},e.children)}}}]);