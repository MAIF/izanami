"use strict";(self.webpackChunkizanami_documentation=self.webpackChunkizanami_documentation||[]).push([[235],{8947:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>h,contentTitle:()=>d,default:()=>f,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var s=i(5893),a=i(1151),r=i(4982),t=i(6898),c=i(4665);const o={title:"APIs usage"},d=void 0,l={id:"api",title:"APIs usage",description:"Identification",source:"@site/v1/09-api.mdx",sourceDirName:".",slug:"/api",permalink:"/izanami/v1/api",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:9,frontMatter:{title:"APIs usage"},sidebar:"defaultSidebar",previous:{title:"UI usage",permalink:"/izanami/v1/ui"},next:{title:"Shared Configs",permalink:"/izanami/v1/configs/"}},h={},p=[{value:"Identification",id:"identification",level:2},{value:"Error response",id:"error-response",level:2},{value:"Shared config API",id:"shared-config-api",level:2},{value:"Feature flipping API",id:"feature-flipping-api",level:2},{value:"Experiments (A/B testing) API",id:"experiments-ab-testing-api",level:2},{value:"Webhooks API",id:"webhooks-api",level:2},{value:"Users API",id:"users-api",level:2},{value:"Api keys API",id:"api-keys-api",level:2},{value:"Where can I find an OpenApi ?",id:"where-can-i-find-an-openapi-",level:2}];function u(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"identification",children:"Identification"}),"\n",(0,s.jsx)(n.p,{children:"All the APIs needs to be be identified. Identification could be done with a cookie (from the UI) or using headers (random services)."}),"\n",(0,s.jsx)(n.p,{children:"To use header identification, you first need to generate client id and client secret using the UI :"}),"\n",(0,s.jsx)("img",{src:r.Z,width:"50%"}),"\n",(0,s.jsx)(n.p,{children:"And then click add key"}),"\n",(0,s.jsx)("img",{src:t.Z,width:"80%"}),"\n",(0,s.jsx)(n.p,{children:"You can change the client id and client secret if you need it. Hit the create button to finish the creation"}),"\n",(0,s.jsx)("img",{src:c.Z,width:"80%"}),"\n",(0,s.jsxs)(n.p,{children:["You can add restriction on keys using a pattern.\nFor example, you set patterns to ",(0,s.jsx)(n.code,{children:"mykeys:*"})," so the client using this credentials will only see data where the key starts with ",(0,s.jsx)(n.code,{children:"mykeys:"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["When it's done you can use the client id and secret using the headers ",(0,s.jsx)(n.code,{children:"Izanami-Client-Id"})," and ",(0,s.jsx)(n.code,{children:"Izanami-Client-Secret"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'\ncurl -X GET \\\n  \'http://localhost:9000/api/configs/my:config\' \\\n  -H \'Content-Type: application/json\' \\\n  -H \'Izanami-Client-Id: client\' \\\n  -H \'Izanami-Client-Secret: client1234\' --include\n\n# And the result is\n# HTTP/1.1 200 OK\n# Date: Tue, 12 Dec 2017 16:06:46 GMT\n# Content-Type: application/json\n# Content-Length: 76\n#\n# {"id":"my:config","value":"{\\n  \\"message\\": \\"Hello World!\\"\\n}"}\n\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Header names can be change, see the ",(0,s.jsx)(n.a,{href:"settings",children:"settings"})," page."]}),"\n",(0,s.jsx)(n.h2,{id:"error-response",children:"Error response"}),"\n",(0,s.jsx)(n.p,{children:"The format of the errors is consistent across all Izanami APIs."}),"\n",(0,s.jsx)(n.p,{children:"The error format has the following structure :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "errors": [\n    {\n      "message": "pattern.invalid",\n      "args": ["ragnar.lodbrok.gmail.com"]\n    }\n  ],\n  "fieldErrors": {\n    "obj.email": [\n      {\n        "message": "pattern.invalid",\n        "args": ["ragnar.lodbrok.gmail.com"]\n      }\n    ]\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"errors"})," is an array of object error. Each error has","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["a ",(0,s.jsx)(n.code,{children:"message"})," : a key corresponding to a type of error"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"args"})," : an array of additional information that can be used to build the appropriate error message"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"fieldErrors"})," represent validation errors on an object. The resulting structure is an object where","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"keys represent the path of the field of invalid object"}),"\n",(0,s.jsx)(n.li,{children:"value is an array of message and args as explained above"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"shared-config-api",children:"Shared config API"}),"\n",(0,s.jsxs)(n.p,{children:["Go to the ",(0,s.jsx)(n.a,{href:"./configs/api",children:"configs API doc"})]}),"\n",(0,s.jsx)(n.h2,{id:"feature-flipping-api",children:"Feature flipping API"}),"\n",(0,s.jsxs)(n.p,{children:["Go to the ",(0,s.jsx)(n.a,{href:"./features-flipping/api",children:"features API doc"})]}),"\n",(0,s.jsx)(n.h2,{id:"experiments-ab-testing-api",children:"Experiments (A/B testing) API"}),"\n",(0,s.jsxs)(n.p,{children:["Go to the ",(0,s.jsx)(n.a,{href:"./experiments/api",children:"experiments API doc"})]}),"\n",(0,s.jsx)(n.h2,{id:"webhooks-api",children:"Webhooks API"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"TODO"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"users-api",children:"Users API"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"TODO"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"api-keys-api",children:"Api keys API"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"TODO"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"where-can-i-find-an-openapi-",children:"Where can I find an OpenApi ?"}),"\n",(0,s.jsxs)(n.p,{children:["Go see the ",(0,s.jsx)(n.a,{href:"pathname:///v1/swagger-ui.html",children:"open api"})]}),"\n",(0,s.jsxs)(n.p,{children:["Once you have an instance running (see ",(0,s.jsx)(n.a,{href:"./",children:"Quickstart"}),"), you can find the swagger doc at ",(0,s.jsx)(n.code,{children:"http://localhost:9000/docs/swagger-ui/index.html?url=/assets/swagger.json"}),"."]})]})}function f(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},4982:(e,n,i)=>{i.d(n,{Z:()=>s});const s=i.p+"assets/images/3-apikey-cb34c7b078d1f8c9dd2d30a6a76f24bb.png"},6898:(e,n,i)=>{i.d(n,{Z:()=>s});const s=i.p+"assets/images/4-addkey-09dbfb3c4c6af89dcabcac829185c879.png"},4665:(e,n,i)=>{i.d(n,{Z:()=>s});const s=i.p+"assets/images/5-createkey-df12aea48e9a20aae06bc7ed688c96e6.png"},1151:(e,n,i)=>{i.d(n,{Z:()=>c,a:()=>t});var s=i(7294);const a={},r=s.createContext(a);function t(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);