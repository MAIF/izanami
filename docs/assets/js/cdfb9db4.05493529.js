"use strict";(self.webpackChunkizanami_documentation=self.webpackChunkizanami_documentation||[]).push([[9076],{6342:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var i=a(5893),t=a(1151);const r={title:"React client"},o=void 0,s={id:"clients/react",title:"React client",description:"react-izanami is a simple set of React components to leverage the power of Izanami feature flipping and experiments.",source:"@site/v1/17-clients/02-react.mdx",sourceDirName:"17-clients",slug:"/clients/react",permalink:"/izanami/v1/clients/react",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"React client"},sidebar:"defaultSidebar",previous:{title:"Java & Scala",permalink:"/izanami/v1/clients/jvm"},next:{title:"Node js client",permalink:"/izanami/v1/clients/node"}},l={},c=[{value:"Install the client",id:"install-the-client",level:2},{value:"Import",id:"import",level:2},{value:"Izanami provider",id:"izanami-provider",level:2},{value:"Feature flipping",id:"feature-flipping",level:2},{value:"Experiments (A/B testing)",id:"experiments-ab-testing",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"react-izanami"})," is a simple set of React components to leverage the power of Izanami feature flipping and experiments."]}),"\n",(0,i.jsx)(n.p,{children:"In order to use the client you need to proxify Izanami to avoid leaking the credentials to the client side."}),"\n",(0,i.jsxs)(n.p,{children:["You can use the ",(0,i.jsx)(n.a,{href:"./jvm#exposing-izanami-with-a-proxy",children:"jvm proxy"}),", the ",(0,i.jsx)(n.a,{href:"./node",children:"node proxy"})," or write your own proxy."]}),"\n",(0,i.jsx)(n.h2,{id:"install-the-client",children:"Install the client"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install react-izanami\n"})}),"\n",(0,i.jsx)(n.h2,{id:"import",children:"Import"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",metastring:"harmony",children:"import {IzanamiProvider, Feature, Enabled, Disabled, Experiment, Variant, Api as IzanamiApi} from 'react-izanami';\n"})}),"\n",(0,i.jsx)(n.h2,{id:"izanami-provider",children:"Izanami provider"}),"\n",(0,i.jsx)(n.p,{children:"You can wrap your application in the izanami provider and let izanami fetch data from the proxy you have exposed:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",metastring:"harmony",children:'  <IzanamiProvider fetchFrom="/api/izanami">\n    {/* your app */}    \n  </IzanamiProvider>\n'})}),"\n",(0,i.jsx)(n.p,{children:"Or"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",metastring:"harmony",children:"  <IzanamiProvider\n          id = \"provider1\"\n          fetchFrom={() =>\n              fetch(\"/api/izanami\", {\n                  method: 'GET',\n                  credentials: 'include'                \n              })\n          }>\n    {/* your app */}    \n  </IzanamiProvider>\n"})}),"\n",(0,i.jsx)(n.p,{children:"If you register a function, you need an id because you can register multiple provider."}),"\n",(0,i.jsx)(n.p,{children:"You can pass fallbacks in the case of the server is not up:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",metastring:"harmony",children:"<IzanamiProvider fetchFrom=\"/api/izanami\" featuresFallback={{my: {feature: {active: true}}}} experimentsFallback={{my:{experiment:{variant: 'B'}}}} >\n{/* ... */}    \n</IzanamiProvider>\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can also pass features and experiments as props if you don't want the provider to fetch datas:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",metastring:"harmony",children:"<IzanamiProvider features={{my: {feature: {active: true}}}} experiments={{my:{experiment:{variant: 'B'}}}} >\n{/* ... */}\n</IzanamiProvider>\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can trigger manual reload using the Api class. For example during router transition :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",metastring:"harmony",children:'componentWillReceiveProps(nextProps) {\n    // will be true\n    const locationChanged = nextProps.location !== this.props.location;\n    if (locationChanged) {\n      //Reload izanami data on route change\n      IzanamiApi.izanamiReload("/api/izanami");\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Or if an id was used"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",metastring:"harmony",children:'componentWillReceiveProps(nextProps) {\n    // will be true\n    const locationChanged = nextProps.location !== this.props.location;\n    if (locationChanged) {\n      //Reload izanami data on route change\n      IzanamiApi.izanamiReload("provider1");\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"feature-flipping",children:"Feature flipping"}),"\n",(0,i.jsx)(n.p,{children:"Once you the provider configured, you can switch code depending on a feature :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",metastring:"harmony",children:'<Feature path="izanami.example.deleteAll">\n  <Enabled>\n    <tr>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td><button type="button"  className="btn btn-sm btn-default" onClick={this.deleteAll}>Delete done items</button></td>\n    </tr>\n  </Enabled>\n  <Disabled>\n    <tr></tr>\n  </Disabled>\n</Feature>\n'})}),"\n",(0,i.jsx)(n.h2,{id:"experiments-ab-testing",children:"Experiments (A/B testing)"}),"\n",(0,i.jsx)(n.p,{children:"Once you the provider configured, you can displayed a specific variant for an experiment :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",metastring:"harmony",children:'{this.state.todoLists.map(l =>\n    <tr key={`td-${l.name}`}>\n      <td><Link to={`/todos/${l.name}`} >{l.name}</Link></td>\n      <td>{l.user}</td>\n      <td>\n        <Experiment path={"izanami:example:button"} notifyDisplay="/api/izanami/experiments/displayed" >\n          <Variant id={"A"}>\n            <Link to={`/todos/${l.name}`} onClick={this.onTodosClick} className="btn btn-sm btn-default"><i className="fas fa-eye" aria-hidden="true" /></Link>\n            <button className="btn btn-sm btn-default" onClick={this.removeTodoList(l.name)}><i className="glyphicon glyphicon-trash" /></button>\n          </Variant>\n          <Variant id={"B"}>\n            <Link to={`/todos/${l.name}`} onClick={this.onTodosClick} className="btn btn-sm btn-primary"><i className="glyphicon glyphicon-pencil" /></Link>\n            <button className="btn btn-sm btn-primary" onClick={this.removeTodoList(l.name)}><i className="glyphicon glyphicon-trash" /></button>\n          </Variant>\n        </Experiment>\n      </td>\n    </tr>\n)}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["If specified, the ",(0,i.jsx)(n.code,{children:"notifyDisplay"})," field will call the registered url to notify Izanami that the current variant is displayed."]}),"\n",(0,i.jsx)(n.p,{children:"You have to call yourself Izanami when a variant won because the react client can't decide this for you :)."}),"\n",(0,i.jsxs)(n.p,{children:["In this example, the variant won if the client click on the button.\nFor that we will do an http POST on ",(0,i.jsx)(n.code,{children:"/api/izanami/experiments/won"})," when the client click on the link using this function :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"export function notifyWon(key) {\n  return fetch(`/api/izanami/experiments/won?experiment=${key}`, {\n    method: 'POST',\n    credentials: 'include',\n    headers: {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json'\n    }\n  });\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"and then when the client click on the link:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'onTodosClick = () => {\n  Service.notifyWon("izanami:example:button");\n};\n'})})]})}function p(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1151:(e,n,a)=>{a.d(n,{Z:()=>s,a:()=>o});var i=a(7294);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);