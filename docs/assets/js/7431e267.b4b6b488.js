"use strict";(self.webpackChunkizanami_documentation=self.webpackChunkizanami_documentation||[]).push([[9551],{8533:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>x,contentTitle:()=>u,default:()=>k,frontMatter:()=>p,metadata:()=>m,toc:()=>j});var o=s(5893),t=s(1151);const i=s.p+"assets/images/simple-filled-form-3c58792d51cbd089226e6f28c776f5c0.png",r=s.p+"assets/images/secret-modal-1b6c5baa3bd16f1301423360e632267b.png",a=s.p+"assets/images/more-right-form-94084d4afbb97f7d3346e2a22961b611.png",c=s.p+"assets/images/token-table-131a73aeb9ceb4825275821d72a81c11.png",l=s.p+"assets/images/other-user-tokens-ae3c3b73b96f7b2e922f8f906b5d31b2.png",d=s.p+"assets/images/create-token-button-33ba066a6a15f4618e9d0d40c928f3b6.png";var h=s(1361);const p={title:"Access tokens"},u="What should I use personnal access token for ?",m={id:"guides/personnal-access-tokens",title:"Access tokens",description:"Izanami UI is the main channel to manage your features. However sometimes you need to automatize some operations.",source:"@site/docs/04-guides/16-personnal-access-tokens.mdx",sourceDirName:"04-guides",slug:"/guides/personnal-access-tokens",permalink:"/izanami/docs/guides/personnal-access-tokens",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:16,frontMatter:{title:"Access tokens"},sidebar:"tutorialSidebar",previous:{title:"Non boolean features",permalink:"/izanami/docs/guides/non-boolean-features"},next:{title:"Audit logs",permalink:"/izanami/docs/guides/audit-logs"}},x={},j=[{value:"How does personnal access token works",id:"how-does-personnal-access-token-works",level:2},{value:"How to use access tokens",id:"how-to-use-access-tokens",level:2},{value:"Export endpoint",id:"export-endpoint",level:3},{value:"Import endpoint",id:"import-endpoint",level:3}];function f(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["Izanami UI is the main channel to manage your features. However sometimes you need to automatize some operations.\nFor such needs, Izanami allows to call some Izanami admin endpoints with ",(0,o.jsx)(n.strong,{children:"personnal access tokens"}),"."]}),"\n",(0,o.jsx)(h.j,{children:"Personnal acces tokens are available from Izanami 2.6.0."}),"\n",(0,o.jsx)(n.h1,{id:"what-should-i-use-personnal-access-token-for-",children:"What should I use personnal access token for ?"}),"\n",(0,o.jsx)(n.p,{children:"A personnal acess token allows to call some Izanami admin endpoints from code."}),"\n",(0,o.jsx)(n.p,{children:"For instance you may want to automatically synchronize two Izanami instances using import/export endpoints."}),"\n",(0,o.jsx)(n.h2,{id:"how-does-personnal-access-token-works",children:"How does personnal access token works"}),"\n",(0,o.jsxs)(n.p,{children:["Personnal access tokens perform operation ",(0,o.jsx)(n.strong,{children:"in their owner name"})," and ",(0,o.jsx)(n.strong,{children:"with their owner rights"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"Tokens can have either all their owner rights or a subset of their rights."}),"\n",(0,o.jsxs)(n.p,{children:["In all cases, a token can ",(0,o.jsx)(n.strong,{children:"never have more rights than its owner"}),". This means that if a user lost some rights, tokens previously generated with these rights will loose them as well."]}),"\n",(0,o.jsxs)(h.j,{children:[(0,o.jsxs)(n.p,{children:["Personnal access tokens should be considered as ",(0,o.jsx)(n.strong,{children:"passwords"}),".\n",(0,o.jsx)("br",{})," Therefore Izanami will display them once (at creation) and store them encrypted\nin database."]}),(0,o.jsx)("br",{}),(0,o.jsx)("strong",{children:"This means that there is no way to recover a lost token."})]}),"\n",(0,o.jsx)(n.p,{children:"They can have an expiration date, and don't work once they're expired."}),"\n",(0,o.jsx)(n.p,{children:"You can have multiple access tokens."}),"\n",(0,o.jsx)(h.j,{children:(0,o.jsx)(n.p,{children:"It's recommended to have a token for each use case, this way if a token leaks,\nyou'll have less places to update."})}),"\n",(0,o.jsx)(n.h2,{id:"how-to-use-access-tokens",children:"How to use access tokens"}),"\n",(0,o.jsx)(n.p,{children:"Right now, access tokens can be used on two endpoints:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"/api/admin/tenants/<YOUR_TENANT>/_export"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"/api/admin/tenants/<YOUR_TENANT>/_import"})}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Tokens may be used on more endpoints in the future, please ",(0,o.jsx)(n.a,{href:"https://github.com/MAIF/izanami/issues",children:"open an issue"})," if you encounter such need."]}),"\n",(0,o.jsx)(n.p,{children:"Access tokens must be used as password in a Basic auth header, where username is username of token owners."}),"\n",(0,o.jsx)(n.h3,{id:"export-endpoint",children:"Export endpoint"}),"\n",(0,o.jsx)(n.p,{children:"Here is an example of export endpoint call using an access token:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:'curl -H "Content-Type: application/json" \\\n  -u "<USERNAME>:<ACCESS TOKEN>" \\\n  --data \'{\n    "allProjects": true,\n    "allKeys": true,\n    "allWebhooks": true,\n    "userRights": false,\n    "webhooks": [],\n    "projects": [],\n    "keys": []\n  }\' \\\n"<IZANAMI_URL>/api/admin/tenants/<TENANT>/_export"\n'})}),"\n",(0,o.jsx)(n.p,{children:"where:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"allProjects: indicates whether or not all tenants projects should be exported"}),"\n",(0,o.jsx)(n.li,{children:"allKeys: indicates whether or not all tenants keys should be exported"}),"\n",(0,o.jsx)(n.li,{children:"allWebhooks: indicates whether or not all tenants webhooks should be exported"}),"\n",(0,o.jsx)(n.li,{children:"userRights: indicate whether or not user rights should be exported"}),"\n",(0,o.jsxs)(n.li,{children:["webhooks: if ",(0,o.jsx)(n.code,{children:"allWebhooks"})," is false, list webhooks ids to export"]}),"\n",(0,o.jsxs)(n.li,{children:["projects: if ",(0,o.jsx)(n.code,{children:"allProjects"})," is false, list webhooks ids to export"]}),"\n",(0,o.jsxs)(n.li,{children:["keys: if ",(0,o.jsx)(n.code,{children:"allKeys"})," is false, list key ids to export"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"import-endpoint",children:"Import endpoint"}),"\n",(0,o.jsxs)(n.p,{children:["Here is an example of import endpoint call using an access token (where file to import is named ",(0,o.jsx)(n.code,{children:"import.ndjson"}),")."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:'curl -F "export=@import.ndjson" \\\n -u "<USERNAME>:<ACCESS TOKEN>" \\\n "<IZANAMI_URL>/api/admin/tenants/<TENANT>/_import?version=2&conflict=skip"\n'})}),"\n",(0,o.jsx)(n.p,{children:"where:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"import.ndjson"})," should contain previously exported data"]}),"\n",(0,o.jsx)(n.li,{children:"version can be 1 or 2, depending on where exported data are from (Izanami v1 or v2)"}),"\n",(0,o.jsxs)(n.li,{children:["conflict can be ",(0,o.jsx)(n.code,{children:"skip"}),", ",(0,o.jsx)(n.code,{children:"overwrite"})," or ",(0,o.jsx)(n.code,{children:"fail"})," (see ",(0,o.jsx)(n.a,{href:"./transfer-data",children:"this page foe details"}),")"]}),"\n"]}),"\n",(0,o.jsx)(n.h1,{id:"example",children:"Example"}),"\n",(0,o.jsx)(n.p,{children:'To create personnal acess token you\'ll need to go to your profile page (click on your username in the top right corner, then "Profile").'}),"\n",(0,o.jsx)(n.p,{children:'At the bottom on this page, click the "Create token" button to open token creation form.'}),"\n",(0,o.jsx)("img",{src:d}),"\n",(0,o.jsx)(n.p,{children:"This form allows to define:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"token name"}),"\n",(0,o.jsx)(n.li,{children:"token expiration (tokens will have no expiration if field is empty, which is not recommended)"}),"\n",(0,o.jsx)(n.li,{children:"token rights (either all user rights, or a subset)"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Let's create a simple token with all current user rights."}),"\n",(0,o.jsx)("img",{src:i}),"\n",(0,o.jsxs)(n.p,{children:["Once you save your token, a modal will appear with token secret.\n",(0,o.jsx)(n.strong,{children:"Make sure to copy the secret before closing the modal"}),", it won't be displayed again."]}),"\n",(0,o.jsx)("img",{src:r}),"\n",(0,o.jsx)(n.p,{children:"It's also possible to customize token rights, to limit them to given tenant and/or actions."}),"\n",(0,o.jsx)("img",{src:a}),"\n",(0,o.jsx)(n.p,{children:"All your tokens are visible in your profile page."}),"\n",(0,o.jsx)("img",{src:c}),"\n",(0,o.jsx)(h.j,{children:(0,o.jsxs)(n.p,{children:["Secret associated with a personnal access token is composed of two parts: ",(0,o.jsx)(n.code,{children:"<ID>_<crypted-stuff>"}),".",(0,o.jsx)("br",{}),"\n",(0,o.jsx)(n.code,{children:"ID"})," can be used to identify a token in case of need. To do so, just paste your ID in search field of the ID column."]})}),"\n",(0,o.jsx)(n.p,{children:"Moreover, admin users (admin of the whole Izanami instance) can see, update or delete tokens for any users.\nThese tokens visible in the users page."}),"\n",(0,o.jsx)("img",{src:l})]})}function k(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(f,{...e})}):f(e)}},1361:(e,n,s)=>{s.d(n,{j:()=>r});const o={description__trivia:"description__trivia_yesz"};var t=s(4625),i=s(5893);function r(e){let{children:n}=e;return(0,i.jsxs)("div",{className:o.description__trivia,children:[(0,i.jsx)("img",{src:t.Z}),(0,i.jsx)("div",{children:n})]})}},4625:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/izanami_compressed-659337582c1667d92966e42fa1bfea3f.webp"},1151:(e,n,s)=>{s.d(n,{Z:()=>a,a:()=>r});var o=s(7294);const t={},i=o.createContext(t);function r(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);